(window.webpackJsonpreportEmbed=window.webpackJsonpreportEmbed||[]).push([["reportEmbed.json-contracts.min"],{993:function(e,t,r){"use strict";r.r(t);var n,i=r(0),a=r(58),o=powerbi.data.SQExprBuilder,l=powerbi.data.SQExprConverter,s=function(){function e(){}return e.prototype.getTarget=function(e,t,r){void 0===r&&(r=!0);var n,i=l.asFieldPattern(e,t);return i?(i.columnAggr||r&&i.groupingColumnAggr?n=this.getColumnAggrTarget(i):i.hierarchyLevelAggr?n=this.getHierarchyLevelAggrTarget(i):i.measure?n=this.getMeasureTarget(i):i.hierarchyLevel?n=this.getHierarchyLevelTarget(i):i.column&&(n=this.getColumnTarget(i)),n):null},e.prototype.getFieldExpr=function(e,t,r){var n;if(_.isEmpty(t.schemas),r)n=this.getColumnFieldPattern(e,t,r);else if(Object(a.isHierarchyLevelAggr)(e))n=this.getHierarchyLevelAggrFieldPattern(e,t);else if(Object(a.isColumnAggr)(e))n=this.getColumnAggrFieldPattern(e,t);else if(Object(a.isMeasure)(e))n=this.getMeasureFieldPattern(e,t);else if(Object(a.isHierarchyLevel)(e))n=this.getHierarchyLevelFieldPattern(e,t);else{if(!Object(a.isColumn)(e))throw new Error("Invalid or unsupported target");n=this.getColumnFieldPattern(e,t)}return o.fieldExpr(n)},e.prototype.getColumnFieldPattern=function(e,t,r){var n=r||e.column;return{column:{schema:this.getSchemaName(n,e.table,t),entity:e.table,name:n}}},e.prototype.getMeasureFieldPattern=function(e,t){return{measure:{schema:this.getSchemaName(e.measure,e.table,t),entity:e.table,name:e.measure}}},e.prototype.getHierarchyLevelFieldPattern=function(e,t){return{hierarchyLevel:{schema:this.getSchemaName(e.hierarchy,e.table,t,!0),entity:e.table,name:e.hierarchy,level:e.hierarchyLevel}}},e.prototype.getHierarchyLevelAggrFieldPattern=function(e,t){return{hierarchyLevelAggr:{schema:this.getSchemaName(e.hierarchy,e.table,t,!0),entity:e.table,name:e.hierarchy,level:e.hierarchyLevel,aggregate:this.getQueryAggregateFunction(e.aggregationFunction)}}},e.prototype.getColumnAggrFieldPattern=function(e,t){return{columnAggr:{schema:this.getSchemaName(e.column,e.table,t),entity:e.table,name:e.column,aggregate:this.getQueryAggregateFunction(e.aggregationFunction)}}},e.prototype.getQueryAggregateFunction=function(e){switch(e){case"Sum":return 0;case"Avg":return 1;case"Count":return 2;case"Min":return 3;case"Max":return 4;case"CountNonNull":return 5;case"Median":return 6;case"StandardDeviation":return 7;case"Variance":return 8}},e.prototype.getColumnTarget=function(e){var t=e.column;return{$schema:"http://powerbi.com/product/schema#column",column:t.name,table:t.entity}},e.prototype.getColumnAggrTarget=function(e,t){void 0===t&&(t=!0);var r=e.columnAggr||t&&e.groupingColumnAggr;return r?{$schema:"http://powerbi.com/product/schema#columnAggr",column:r.name,table:r.entity,aggregationFunction:powerbi.data.aggregateFunctionName(r.aggregate)}:null},e.prototype.getMeasureTarget=function(e){var t=e.measure;return{$schema:"http://powerbi.com/product/schema#measure",measure:t.name,table:t.entity}},e.prototype.getHierarchyLevelTarget=function(e){var t=e.hierarchyLevel;return{$schema:"http://powerbi.com/product/schema#hierarchyLevel",hierarchy:t.name,hierarchyLevel:t.level,table:t.entity}},e.prototype.getHierarchyLevelAggrTarget=function(e){var t=e.hierarchyLevelAggr;return{$schema:"http://powerbi.com/product/schema#hierarchyLevelAggr",hierarchy:t.name,hierarchyLevel:t.level,table:t.entity,aggregationFunction:powerbi.data.aggregateFunctionName(t.aggregate)}},e.prototype.getSchemaName=function(e,t,r,n){void 0===n&&(n=!1);for(var i=0,a=r.schemas;i<a.length;i++){var o=a[i];if(o.findProperty(t,e)||n&&o.findHierarchy(t,e))return o.name}},e.ngInjectableDef=i["ɵɵdefineInjectable"]({factory:function(){return new e},token:e,providedIn:"root"}),e}();!function(e){e.NotIn="NotIn",e.SelectAll="All",e.operatorDictionary={None:0,LessThan:1,LessThanOrEqual:2,GreaterThan:3,GreaterThanOrEqual:4,Contains:5,DoesNotContain:6,StartsWith:7,DoesNotStartWith:8,Is:9,IsNot:10,IsBlank:11,IsNotBlank:12},e.logicalOperatorDictionary={Or:1,And:0},function(e){e.InvalidDataType="InvalidDataType",e.FieldNotFound="FieldNotFound",e.FilterConditionNotFound="FilterConditionNotFound"}(e.ErrorCodes||(e.ErrorCodes={})),function(e){e.InvalidTarget="Could not serialize json filter target to SQ expression.",e.InvalidDataTypeMessage="The data type of the value {0} is not supported. Only string, number and boolean are supported.",e.InvalidCondition="Advanced filter requires a filter condition (None | LessThan | LessThanOrEqual | GreaterThan | GreaterThanOrEqual | Contains | DoesNotContain | StartsWith | DoesNotStartWith | Is | IsNot | IsBlank | IsNotBlank)."}(e.ErrorMessages||(e.ErrorMessages={}))}(n||(n={}));var u=function(){function e(){}return e.prototype.fieldNotFound=function(e){var t=e?"Target table: "+e.table:"";return{name:n.ErrorCodes.FieldNotFound,message:n.ErrorMessages.InvalidTarget+t}},e.prototype.invalidDataType=function(e){return{name:n.ErrorCodes.InvalidDataType,message:jsCommon.StringExtensions.format(n.ErrorMessages.InvalidDataTypeMessage,e)}},e.prototype.filterConditionNotFound=function(){return{name:n.ErrorCodes.FilterConditionNotFound,message:n.ErrorMessages.InvalidCondition}},e.ngInjectableDef=i["ɵɵdefineInjectable"]({factory:function(){return new e},token:e,providedIn:"root"}),e}(),c=powerbi.data.Condition,p=jsCommon.DateExtensions,g=powerbi.explore.viewModels.FilterCardConverter,d=powerbi.explore.FilterUtils,h=powerbi.data.SemanticFilter,m=jsCommon.Utility,v=function(){function e(e,t){this.jsonTargetParserService=e,this.errorProvider=t}return e.prototype.tryBuildFilterContainer=function(e,t,r){if(Object(a.getFilterType)(r)!==this.getFilterType())return null;var i,o=r,l=this.jsonTargetParserService.getFieldExpr(o.target,t);l||m.throwException(this.errorProvider.fieldNotFound(o.target));for(var s=[],u=0,c=o.conditions;u<c.length;u++){var p=c[u],v=this.getCondition(p);v&&s.push(v)}var y=l.getMetadata(t),f=y?y.type:null,F=n.logicalOperatorDictionary[o.logicalOperator],b=g.toSQExpr(l,f,s,F);return b&&(i={name:d.getNextFilterName(e.filters),expression:l,filter:h.fromSQExpr(b),type:powerbi.explore.contracts.FilterType.Advanced}),i},e.prototype.getFilterType=function(){return a.FilterType.Advanced},e.prototype.getCondition=function(e){e||m.throwException(this.errorProvider.filterConditionNotFound());var t,r=n.operatorDictionary[e.operator];return t=_.isString(e.value)&&p.parseIsoDateFast(e.value.substr(0,26))?p.parseIsoDateFast(e.value.substr(0,26)):e.value,new c(r,t)},e.ngInjectableDef=i["ɵɵdefineInjectable"]({factory:function(){return new e(i["ɵɵinject"](s),i["ɵɵinject"](u))},token:e,providedIn:"root"}),e}(),y=powerbi.explore.FilterUtils,f=powerbi.data.SQExprBuilder,F=powerbi.data.SemanticFilter,b=jsCommon.Utility,T=function(){function e(e,t){this.jsonTargetParserService=e,this.errorProvider=t}return e.prototype.tryBuildFilterContainer=function(e,t,r){if(Object(a.getFilterType)(r)!==this.getFilterType())return null;var i,o=r,l=this.jsonTargetParserService.getFieldExpr(o.target,t);if(l||b.throwException(this.errorProvider.fieldNotFound(o.target)),o.operator!==n.SelectAll){for(var s=this.getFieldExprsForKeys(o.target,t),u=[],c=0,p=0,g=o.values;p<g.length;p++){var d=g[p],h=[],m=o.keyValues;if(s&&m)for(var v=0,T=m[c];v<T.length;v++){var C=T[v];h.push(this.buildSQConstantExpr(C))}else h.push(this.buildSQConstantExpr(d));u.push(h),c++}var D=f.inValues(s||[l],u),E=void 0;E=o.operator===n.NotIn?f.not(D):D,i=F.fromSQExpr(E)}return{name:y.getNextFilterName(e.filters),expression:l,filter:i,type:powerbi.explore.contracts.FilterType.Categorical}},e.prototype.getFilterType=function(){return a.FilterType.Basic},e.prototype.buildSQConstantExpr=function(e){var t;if(_.isString(e))if(null!=jsCommon.DateExtensions.parseIsoDateFast(e.substr(0,26))){var r=jsCommon.DateExtensions.parseIsoDateFast(e.substr(0,26));t=f.dateTime(r)}else t=f.text(e);else _.isBoolean(e)?t=f.boolean(e):_.isNumber(e)?t=powerbi.Double.isInteger(e)?f.integer(e):f.double(e):null===e?t=f.nullConstant():b.throwException(this.errorProvider.invalidDataType(e));return t},e.prototype.getFieldExprsForKeys=function(e,t){var r=this;return e&&e.keys?_.map(e.keys,function(n){return r.jsonTargetParserService.getFieldExpr(e,t,n)}):null},e.ngInjectableDef=i["ɵɵdefineInjectable"]({factory:function(){return new e(i["ɵɵinject"](s),i["ɵɵinject"](u))},token:e,providedIn:"root"}),e}(),C=powerbi.explore.FilterUtils,D=jsCommon.Utility,E=function(){function e(e,t){this.jsonTargetParserService=e,this.errorProvider=t}return e.prototype.tryBuildFilterContainer=function(e,t,r){if(Object(a.getFilterType)(r)!==this.getFilterType())return null;var n=r,i=this.jsonTargetParserService.getFieldExpr(r.target,t),o=this.jsonTargetParserService.getFieldExpr(n.orderBy,t);if(!i||!o)throw D.throwException(this.errorProvider.fieldNotFound(r.target)),{};var l={fieldBeingFiltered:i,isTop:"Top"===n.operator,itemCount:n.itemCount,orderByField:o},s=powerbi.data.TopNFilterPattern.buildFilterFromParameters(l);return{name:C.getNextFilterName(e.filters),expression:i,filter:s,type:powerbi.explore.contracts.FilterType.TopN}},e.prototype.getFilterType=function(){return a.FilterType.TopN},e.ngInjectableDef=i["ɵɵdefineInjectable"]({factory:function(){return new e(i["ɵɵinject"](s),i["ɵɵinject"](u))},token:e,providedIn:"root"}),e}(),x=powerbi.explore.FilterUtils,N=jsCommon.Utility,j=powerbi.data,w=function(){function e(e,t){this.jsonTargetParserService=e,this.errorProvider=t}return e.prototype.tryBuildFilterContainer=function(e,t,r){if(Object(a.getFilterType)(r)!==this.getFilterType())return null;var n=r,i=j.RelativeDateFilterPattern.buildSemanticFilter(this.createRelativeDateFilterParameters(n,t));return{name:x.getNextFilterName(e.filters),expression:this.jsonTargetParserService.getFieldExpr(r.target,t),filter:i,type:powerbi.explore.contracts.FilterType.RelativeDate}},e.prototype.createRelativeDateFilterParameters=function(e,t){var r=this.jsonTargetParserService.getFieldExpr(e.target,t);return r||N.throwException(this.errorProvider.fieldNotFound(e.target)),{field:r,options:{duration:e.timeUnitsCount,includeToday:e.includeToday,relativeQualifier:this.translateToRelativeDateQualifierEnum(e.operator),relativeUnit:this.translateToRelativeDateUnitEnum(e.timeUnitType)}}},e.prototype.translateToRelativeDateUnitEnum=function(e){switch(e){case a.RelativeDateFilterTimeUnit.Days:return j.RelativeDateUnit.Day;case a.RelativeDateFilterTimeUnit.Weeks:return j.RelativeDateUnit.Week;case a.RelativeDateFilterTimeUnit.CalendarWeeks:return j.RelativeDateUnit.CalendarWeek;case a.RelativeDateFilterTimeUnit.Months:return j.RelativeDateUnit.Month;case a.RelativeDateFilterTimeUnit.CalendarMonths:return j.RelativeDateUnit.CalendarMonth;case a.RelativeDateFilterTimeUnit.Years:return j.RelativeDateUnit.Year;case a.RelativeDateFilterTimeUnit.CalendarYears:return j.RelativeDateUnit.CalendarYear;default:return}},e.prototype.translateToRelativeDateQualifierEnum=function(e){switch(e){case a.RelativeDateOperators.InLast:return j.RelativeDateQualifier.Last;case a.RelativeDateOperators.InThis:return j.RelativeDateQualifier.Current;case a.RelativeDateOperators.InNext:return j.RelativeDateQualifier.Next;default:return}},e.prototype.getFilterType=function(){return a.FilterType.RelativeDate},e.ngInjectableDef=i["ɵɵdefineInjectable"]({factory:function(){return new e(i["ɵɵinject"](s),i["ɵɵinject"](u))},token:e,providedIn:"root"}),e}(),I=function(){function e(e,t,r,n){this.filterContainerBuilders=[e,t,r,n]}return e.prototype.tryBuildFilterContainer=function(e,t,r){for(var n=0,i=this.filterContainerBuilders;n<i.length;n++){var a=i[n].tryBuildFilterContainer(e,t,r);if(a)return a}},e}(),S=function(){return function(){}}(),P=r(1);r.d(t,"JsonContractsModuleNgFactory",function(){return R});var R=i["ɵcmf"](S,[],function(e){return i["ɵmod"]([i["ɵmpd"](512,i.ComponentFactoryResolver,i["ɵCodegenComponentFactoryResolver"],[[8,[]],[3,i.ComponentFactoryResolver],i.NgModuleRef]),i["ɵmpd"](4608,P.o,P.n,[i.LOCALE_ID,[2,P.F]]),i["ɵmpd"](4608,"jsonTargetParserService",s,[]),i["ɵmpd"](4608,"filterContainerProvider",I,[v,T,E,w]),i["ɵmpd"](1073742336,P.c,P.c,[]),i["ɵmpd"](1073742336,S,S,[])])})}}]);